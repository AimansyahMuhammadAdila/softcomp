<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ”¥ Optimasi Pakan Sapi - ULTRA MODE ðŸš€</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <!DOCTYPE html>
    <html lang="id">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ðŸ”¥ Optimasi Pakan Sapi - ULTRA MODE ðŸš€</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&display=swap"
            rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    </head>

<body>
    <!-- Splash Screen -->
    <div id="splash-screen">
        <div class="splash-content">
            <i class="fa-solid fa-cow fa-bounce"
                style="font-size: 5rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
            <h1>Optimasi Pakan Sapi</h1>
            <p>Memuat Sistem AI...</p>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
        </div>
    </div>

    <div class="background-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
    </div>

    <div class="container">
        <header>
            <h1><i class="fa-solid fa-cow fa-bounce" style="--fa-animation-duration: 3s;"></i> Optimasi Pakan Sapi</h1>
            <p>Powered by Genetic Algorithm AI</p>
        </header>

        <main>
            <div class="card input-section">
                <h2><i class="fa-solid fa-sliders"></i> Parameter Input</h2>

                <div class="form-group">
                    <label>Target Nutrisi</label>
                    <div class="row">
                        <div class="col">
                            <label for="required_prdd">Protein (Prdd) (kg)</label>
                            <input type="number" id="required_prdd" step="0.001" value="1.036">
                        </div>
                        <div class="col">
                            <label for="required_mp">Martabat Pati (MP) (kg)</label>
                            <input type="number" id="required_mp" step="0.001" value="7.5">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="table-header">
                        <label>Data Pakan</label>
                        <button id="add-feed-btn" class="btn-small"><i class="fa-solid fa-plus"></i> Tambah
                            Bahan</button>
                    </div>
                    <div class="table-container">
                        <table id="feed-table">
                            <thead>
                                <tr>
                                    <th>Nama Bahan</th>
                                    <th>Harga (Rp)</th>
                                    <th>Prdd</th>
                                    <th>MP</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for feed in default_feeds %}
                                <tr>
                                    <td><input type="text" class="feed-name" value="{{ feed.name }}"></td>
                                    <td><input type="number" class="feed-price" value="{{ feed.price }}"></td>
                                    <td><input type="number" class="feed-prdd" step="0.01" value="{{ feed.prdd }}"></td>
                                    <td><input type="number" class="feed-mp" step="0.01" value="{{ feed.mp }}"></td>
                                    <td><button class="btn-icon delete-row"><i class="fa-solid fa-trash"></i></button>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="accordion">
                    <div class="accordion-header" id="advanced-settings-toggle">
                        <span><i class="fa-solid fa-microchip"></i> AI Core Settings (Genetic Algorithm)</span>
                        <i class="fa-solid fa-chevron-down arrow"></i>
                    </div>
                    <div class="accordion-content" id="advanced-settings-content">
                        <div class="row">
                            <div class="col">
                                <label for="pop_size">Ukuran Populasi</label>
                                <input type="number" id="pop_size" value="100">
                            </div>
                            <div class="col">
                                <label for="max_gen">Maksimal Generasi</label>
                                <input type="number" id="max_gen" value="200">
                            </div>
                        </div>
                        <div class="row" style="margin-top: 1rem;">
                            <div class="col">
                                <label for="crossover_rate">Crossover Rate</label>
                                <input type="number" id="crossover_rate" step="0.1" value="0.3">
                            </div>
                            <div class="col">
                                <label for="mutation_rate">Mutation Rate</label>
                                <input type="number" id="mutation_rate" step="0.1" value="0.3">
                            </div>
                        </div>
                    </div>
                </div>

                <button id="optimize-btn" class="btn-primary">
                    <span class="btn-text">Jalankan Optimasi AI</span>
                    <span class="loader hidden"></span>
                </button>
            </div>

            <div class="card results-section hidden" id="results-section">
                <h2><i class="fa-solid fa-rocket"></i> Hasil Optimasi</h2>

                <div class="result-summary">
                    <div class="result-item">
                        <span class="label">Total Biaya</span>
                        <span class="value highlight" id="total-cost">Rp 0</span>
                    </div>
                    <div class="result-item">
                        <span class="label">Fitness Score</span>
                        <span class="value" id="best-fitness">0.0000</span>
                    </div>
                </div>

                <div class="nutrition-comparison">
                    <h3><i class="fa-solid fa-chart-bar"></i> Analisis Nutrisi</h3>
                    <div class="progress-group">
                        <div class="progress-label">
                            <span>Protein (Prdd)</span>
                            <span id="prdd-val">0 / 0 kg</span>
                        </div>
                        <div class="progress-bar-bg">
                            <div class="progress-bar" id="prdd-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="progress-group">
                        <div class="progress-label">
                            <span>Martabat Pati (MP)</span>
                            <span id="mp-val">0 / 0 kg</span>
                        </div>
                        <div class="progress-bar-bg">
                            <div class="progress-bar" id="mp-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <h3><i class="fa-solid fa-list-check"></i> Komposisi Pakan Terbaik</h3>
                <div class="table-container">
                    <table id="result-table">
                        <thead>
                            <tr>
                                <th>Nama Bahan</th>
                                <th>Jumlah (kg)</th>
                                <th>Harga Satuan</th>
                                <th>Total Harga</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Results will be injected here -->
                        </tbody>
                    </table>
                </div>

                <div style="margin-top: 2rem; text-align: center;">
                    <button id="show-details-btn" class="btn-small" style="margin: 0 auto;">
                        <i class="fa-solid fa-calculator"></i> Lihat Detail Perhitungan
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Calculation Details Modal -->
    <div id="calc-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fa-solid fa-calculator"></i> Detail Perhitungan</h2>
                <button class="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="modal-body">
                <div class="calc-section">
                    <h3>1. Rumus Dasar</h3>
                    <p>Optimasi ini menggunakan <strong>Algoritma Genetika</strong> untuk mencari kombinasi pakan dengan
                        biaya termurah namun tetap memenuhi kebutuhan nutrisi.</p>
                    <div class="formula-box">
                        <p><strong>Fungsi Objektif (Biaya):</strong></p>
                        <code>Total Biaya = Î£ (Harga_i Ã— Jumlah_i) + Penalti</code>
                        <p><small>*Penalti diberikan jika nutrisi kurang dari target.</small></p>
                    </div>
                </div>

                <div class="calc-section">
                    <h3>2. Perhitungan Nutrisi</h3>
                    <div class="formula-box">
                        <p><strong>Total Protein (Prdd):</strong></p>
                        <code>Î£ (Prdd_i Ã— Jumlah_i) â‰¥ Target Prdd</code>
                        <br><br>
                        <p><strong>Total Martabat Pati (MP):</strong></p>
                        <code>Î£ (MP_i Ã— Jumlah_i) â‰¥ Target MP</code>
                    </div>
                </div>

                <div class="calc-section">
                    <h3>3. Proses Algoritma Genetika</h3>
                    <ul class="step-list">
                        <li><strong>Inisialisasi:</strong> Membuat populasi acak (kombinasi pakan).</li>
                        <li><strong>Evaluasi:</strong> Menghitung fitness (1 / (1 + Biaya Total)).</li>
                        <li><strong>Seleksi:</strong> Memilih individu terbaik.</li>
                        <li><strong>Crossover & Mutasi:</strong> Menghasilkan variasi baru untuk mencari solusi lebih
                            baik.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>

</html>